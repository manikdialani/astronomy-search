{"ast":null,"code":"import \"core-js/modules/esnext.iterator.map.js\";\nimport axios from \"axios\";\nimport InputText from \"primevue/inputtext\";\nimport PaginationBar from \"./PaginationBar.vue\";\nexport default {\n  name: \"SearchSection\",\n  components: {\n    InputText,\n    PaginationBar\n  },\n  data() {\n    return {\n      searchQuery: \"\",\n      pageSize: 10,\n      pageOffset: 0,\n      currentPage: 1,\n      max_pages: null,\n      errorExists: false,\n      errorMessage: \"\",\n      noResultsFound: false,\n      yearOptions: {},\n      selectedYear: null,\n      selectedSearchMethod: \"Regular search\",\n      selectedTokenizer: \"Standard\"\n    };\n  },\n  watch: {\n    searchQuery() {\n      this.pageOffset = 0;\n      if (this.searchQuery !== \"\") {\n        this.getYearOptions();\n        this.handleSearch();\n      } else {\n        this.$emit(\"search-results\", {\n          results: [],\n          timestamp: Date.now()\n        });\n      }\n    },\n    pageSize() {\n      this.handleSearch();\n    },\n    pageOffset() {\n      this.handleSearch();\n    },\n    selectedYear() {\n      this.handleSearch();\n    },\n    selectedSearchMethod() {\n      this.handleSearch();\n    },\n    selectedTokenizer() {\n      this.handleSearch();\n      this.getYearOptions();\n    }\n  },\n  computed: {\n    canPerformSearch() {\n      return this.searchQuery && !this.errorExists;\n    }\n  },\n  methods: {\n    async handleSearch() {\n      if (this.searchQuery === \"\") {\n        this.errorMessage = \"Please enter a search query.\";\n        this.errorExists = true;\n        return;\n      }\n      const year = this.selectedYear ? this.selectedYear.slice(0, 4) : '';\n      let endpoint = \"\";\n      if (this.selectedSearchMethod === \"Semantic search\") {\n        endpoint = `${axios.defaults.baseURL}/api/v1/semantic_search?search_query=${this.searchQuery}&skip=${this.pageOffset}&limit=${this.pageSize}&year=${year}`;\n      } else {\n        endpoint = `${axios.defaults.baseURL}/api/v1/regular_search?search_query=${this.searchQuery}&skip=${this.pageOffset}&limit=${this.pageSize}&year=${year}&tokenizer=${this.selectedTokenizer}`;\n      }\n      await axios.get(endpoint).then(response => {\n        let searchResults = response.data.hits;\n        this.noResultsFound = searchResults.length === 0;\n        this.max_pages = response.data.max_pages;\n\n        // Add timestamp to force reactivity\n        this.$emit(\"search-results\", {\n          results: searchResults,\n          timestamp: Date.now()\n        });\n        this.errorExists = false;\n      }).catch(error => {\n        console.error(error);\n        this.errorMessage = error.response ? error.response.data : 'An error occurred. Please try again.';\n        this.errorExists = true;\n      });\n    },\n    async getYearOptions() {\n      const endpoint = `${axios.defaults.baseURL}/api/v1/get_docs_per_year_count?search_query=${this.searchQuery}&tokenizer=${this.selectedTokenizer}`;\n      await axios.get(endpoint).then(response => {\n        this.yearOptions = Object.entries(response.data.docs_per_year).map(([year, count]) => `${year} (${count})`);\n      }).catch(error => {\n        console.error(error);\n      });\n    },\n    clearSearch() {\n      this.searchQuery = \"\";\n    },\n    handlePageSizeChange(pageSize) {\n      this.pageOffset = 0;\n      this.currentPage = 1;\n      this.pageSize = pageSize;\n    },\n    handleYearChange(year) {\n      this.pageOffset = 0;\n      this.currentPage = 1;\n      this.selectedYear = year;\n    },\n    handlePageChange(page) {\n      this.pageOffset = (page - 1) * this.pageSize;\n      this.currentPage = page;\n    },\n    handleSearchMethodChange(searchMethod) {\n      this.selectedSearchMethod = searchMethod;\n    },\n    handleTokenizerChange(tokenizer) {\n      this.selectedTokenizer = tokenizer;\n    }\n  }\n};","map":{"version":3,"names":["axios","InputText","PaginationBar","name","components","data","searchQuery","pageSize","pageOffset","currentPage","max_pages","errorExists","errorMessage","noResultsFound","yearOptions","selectedYear","selectedSearchMethod","selectedTokenizer","watch","getYearOptions","handleSearch","$emit","results","timestamp","Date","now","computed","canPerformSearch","methods","year","slice","endpoint","defaults","baseURL","get","then","response","searchResults","hits","length","catch","error","console","Object","entries","docs_per_year","map","count","clearSearch","handlePageSizeChange","handleYearChange","handlePageChange","page","handleSearchMethodChange","searchMethod","handleTokenizerChange","tokenizer"],"sources":["C:\\Users\\USER\\Codes\\ElasticSearch_Python_Course\\final_project\\getting_started\\frontend\\src\\components\\SearchSection.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <a href=\"/\" class=\"image-container\">\r\n      <img\r\n        src=\"../assets/galaxy_logo_white.svg\"\r\n        class=\"image-logo\"\r\n        alt=\"My Universe Hub logo\"\r\n      />\r\n    </a>\r\n\r\n    <Transition name=\"fade\">\r\n      <div v-if=\"errorExists\" class=\"error-message small-text\">{{ errorMessage }}</div>\r\n    </Transition>\r\n\r\n    <div class=\"search-container\">\r\n      <InputText\r\n        class=\"input-text medium-text\"\r\n        type=\"text\"\r\n        v-model=\"searchQuery\"\r\n        placeholder=\"Andromeda galaxy\"\r\n        @keyup.enter=\"handleSearch\"\r\n      />\r\n      <span class=\"icon-container\">\r\n        <Transition name=\"fade\">\r\n          <i\r\n            v-if=\"searchQuery\"\r\n            class=\"fas fa-times clear-icon\"\r\n            @click=\"clearSearch\"\r\n            v-tooltip.top=\"'Clear search'\"\r\n          ></i>\r\n        </Transition>\r\n      </span>\r\n    </div>\r\n\r\n    <Transition name=\"fade\">\r\n      <PaginationBar\r\n        ref=\"paginationBar\"\r\n        v-if=\"canPerformSearch\"\r\n        :currentPage=\"currentPage\"\r\n        :maxPages=\"max_pages\"\r\n        :yearOptions=\"yearOptions\"\r\n        @page-size-change=\"handlePageSizeChange\"\r\n        @year-change=\"handleYearChange\"\r\n        @go-to-page=\"handlePageChange\"\r\n        @search-method-change=\"handleSearchMethodChange\"\r\n        @tokenizer-change=\"handleTokenizerChange\"\r\n      />\r\n    </Transition>\r\n\r\n    <Transition name=\"fade\">\r\n      <div v-if=\"noResultsFound\" class=\"no-results-message medium-text\">\r\n        <i class=\"fas fa-search\"></i> No results found.\r\n      </div>\r\n    </Transition>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport InputText from \"primevue/inputtext\";\r\nimport PaginationBar from \"./PaginationBar.vue\";\r\n\r\nexport default {\r\n  name: \"SearchSection\",\r\n  components: {\r\n    InputText,\r\n    PaginationBar,\r\n  },\r\n  data() {\r\n    return {\r\n      searchQuery: \"\",\r\n      pageSize: 10,\r\n      pageOffset: 0,\r\n      currentPage: 1,\r\n      max_pages: null,\r\n      errorExists: false,\r\n      errorMessage: \"\",\r\n      noResultsFound: false,\r\n      yearOptions: {},\r\n      selectedYear: null,\r\n      selectedSearchMethod: \"Regular search\",\r\n      selectedTokenizer: \"Standard\"\r\n    };\r\n  },\r\n  watch: {\r\n    searchQuery() {\r\n      this.pageOffset = 0;\r\n      if (this.searchQuery !== \"\") {\r\n        this.getYearOptions();\r\n        this.handleSearch();\r\n      } else {\r\n        this.$emit(\"search-results\", {\r\n          results: [],\r\n          timestamp: Date.now(),\r\n        });\r\n      }\r\n    },\r\n    pageSize() {\r\n      this.handleSearch();\r\n    },\r\n    pageOffset() {\r\n      this.handleSearch();\r\n    },\r\n    selectedYear() {\r\n      this.handleSearch();\r\n    },\r\n    selectedSearchMethod() {\r\n      this.handleSearch();\r\n    },\r\n    selectedTokenizer() {\r\n      this.handleSearch();\r\n      this.getYearOptions();\r\n    }\r\n  },\r\n  computed: {\r\n    canPerformSearch() {\r\n      return this.searchQuery && !this.errorExists;\r\n    },\r\n  },\r\n  methods: {\r\n    async handleSearch() {\r\n      if (this.searchQuery === \"\") {\r\n        this.errorMessage = \"Please enter a search query.\";\r\n        this.errorExists = true;\r\n        return;\r\n      }\r\n\r\n      const year = this.selectedYear ? this.selectedYear.slice(0, 4) : ''\r\n      let endpoint = \"\"\r\n\r\n      if (this.selectedSearchMethod === \"Semantic search\") {\r\n        endpoint = `${axios.defaults.baseURL}/api/v1/semantic_search?search_query=${this.searchQuery}&skip=${this.pageOffset}&limit=${this.pageSize}&year=${year}`;\r\n      } else {\r\n        endpoint = `${axios.defaults.baseURL}/api/v1/regular_search?search_query=${this.searchQuery}&skip=${this.pageOffset}&limit=${this.pageSize}&year=${year}&tokenizer=${this.selectedTokenizer}`;\r\n      }\r\n      \r\n      await axios\r\n        .get(endpoint)\r\n        .then((response) => {\r\n          let searchResults = response.data.hits;\r\n          this.noResultsFound = searchResults.length === 0;\r\n          this.max_pages = response.data.max_pages;\r\n\r\n          // Add timestamp to force reactivity\r\n          this.$emit(\"search-results\", {\r\n            results: searchResults,\r\n            timestamp: Date.now(),\r\n          });\r\n          this.errorExists = false;\r\n        })\r\n        .catch((error) => {\r\n          console.error(error);\r\n          this.errorMessage = error.response\r\n            ? error.response.data\r\n            : 'An error occurred. Please try again.';\r\n          this.errorExists = true;\r\n        });\r\n    },\r\n    async getYearOptions() {\r\n      const endpoint = `${axios.defaults.baseURL}/api/v1/get_docs_per_year_count?search_query=${this.searchQuery}&tokenizer=${this.selectedTokenizer}`;\r\n      await axios\r\n        .get(endpoint)\r\n        .then((response) => {\r\n          this.yearOptions = Object.entries(response.data.docs_per_year).map(\r\n            ([year, count]) => `${year} (${count})`\r\n          );\r\n        })\r\n        .catch((error) => {\r\n          console.error(error);\r\n        });\r\n    },\r\n    clearSearch() {\r\n      this.searchQuery = \"\";\r\n    },\r\n    handlePageSizeChange(pageSize) {\r\n      this.pageOffset = 0;\r\n      this.currentPage = 1;\r\n      this.pageSize = pageSize;\r\n    },\r\n    handleYearChange(year) {\r\n      this.pageOffset = 0;\r\n      this.currentPage = 1;\r\n      this.selectedYear = year;\r\n    },\r\n    handlePageChange(page) {\r\n      this.pageOffset = (page - 1) * this.pageSize;\r\n      this.currentPage = page;\r\n    },\r\n    handleSearchMethodChange(searchMethod) {\r\n      this.selectedSearchMethod = searchMethod;\r\n    },\r\n    handleTokenizerChange(tokenizer) {\r\n      this.selectedTokenizer = tokenizer;\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n  margin-top: 12rem;\r\n}\r\n\r\n.image-container {\r\n  display: block;\r\n  width: 15rem;\r\n  margin-bottom: 10rem;\r\n}\r\n\r\n.image-logo {\r\n  display: block;\r\n  width: 100%;\r\n}\r\n\r\n.search-container {\r\n  width: 100%;\r\n  position: relative;\r\n  display: inline-block;\r\n}\r\n\r\n.icon-container {\r\n  position: absolute;\r\n  right: 1.5rem;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n  display: flex;\r\n  gap: 0.75rem;\r\n  align-items: center;\r\n}\r\n\r\n.clear-icon {\r\n  cursor: pointer;\r\n  color: var(--primary-color);\r\n  transition: color 0.3s ease;\r\n  font-size: 3rem;\r\n}\r\n\r\n.clear-icon:hover {\r\n  color: #666;\r\n}\r\n\r\n.input-text {\r\n  width: 100%;\r\n  height: 6rem;\r\n  border-radius: 0rem;\r\n}\r\n\r\n.fade-enter-active,\r\n.fade-leave-active {\r\n  transition: opacity 0.3s ease, transform 0.3s ease;\r\n}\r\n\r\n.fade-enter-from,\r\n.fade-leave-to {\r\n  opacity: 0;\r\n  transform: translateY(1rem);\r\n}\r\n\r\n.fade-enter-to,\r\n.fade-leave-from {\r\n  opacity: 1;\r\n  transform: translateY(0);\r\n}\r\n\r\n.error-message {\r\n  margin-bottom: 0.3rem;\r\n  color: rgb(255, 58, 58);\r\n  padding-left: 0.75rem;\r\n  align-self: flex-start;\r\n}\r\n\r\n.no-results-message {\r\n  margin-top: 2rem;\r\n  text-align: center;\r\n  color: #666;\r\n}\r\n\r\n.no-results-message i {\r\n  margin-right: 0.5rem;\r\n}\r\n\r\n@media screen and (max-width: 1920px) {\r\n  .container {\r\n    margin-top: 10rem;\r\n  }\r\n  \r\n  .image-container {\r\n    width: 10rem;\r\n    margin-bottom: 6rem;\r\n  }\r\n\r\n  .input-text {\r\n    height: 4rem;\r\n  }\r\n\r\n  .icon-container {\r\n    right: 1rem;\r\n  }\r\n\r\n  .clear-icon {\r\n    font-size: 2rem;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 1440px) {\r\n  .container {\r\n    margin-top: 9rem;\r\n  }\r\n  \r\n  .image-container {\r\n    width: 10rem;\r\n    margin-bottom: 5rem;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 992px) {\r\n  .container {\r\n    margin-top: 8rem;\r\n  }\r\n  \r\n  .image-container {\r\n    width: 7rem;\r\n  }\r\n  \r\n  .input-text {\r\n    height: 3rem;\r\n  }\r\n\r\n  .icon-container {\r\n    right: 0.625rem;\r\n  }\r\n\r\n  .clear-icon {\r\n    font-size: 1.5rem;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 768px) {\r\n  .container {\r\n    margin-top: 6rem;\r\n  }\r\n  \r\n  .image-container {\r\n    width: 5rem;\r\n    margin-bottom: 4rem;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 576px) {\r\n  .image-container {\r\n    width: 4rem;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 480px) {\r\n  .container {\r\n    margin-top: 5rem;\r\n  }\r\n\r\n  .image-container {\r\n    width: 3rem;\r\n    margin-bottom: 3rem;\r\n  }\r\n\r\n  .input-text {\r\n    height: 3rem;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":";AA0DA,OAAOA,KAAI,MAAO,OAAO;AACzB,OAAOC,SAAQ,MAAO,oBAAoB;AAC1C,OAAOC,aAAY,MAAO,qBAAqB;AAE/C,eAAe;EACbC,IAAI,EAAE,eAAe;EACrBC,UAAU,EAAE;IACVH,SAAS;IACTC;EACF,CAAC;EACDG,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,WAAW,EAAE,EAAE;MACfC,QAAQ,EAAE,EAAE;MACZC,UAAU,EAAE,CAAC;MACbC,WAAW,EAAE,CAAC;MACdC,SAAS,EAAE,IAAI;MACfC,WAAW,EAAE,KAAK;MAClBC,YAAY,EAAE,EAAE;MAChBC,cAAc,EAAE,KAAK;MACrBC,WAAW,EAAE,CAAC,CAAC;MACfC,YAAY,EAAE,IAAI;MAClBC,oBAAoB,EAAE,gBAAgB;MACtCC,iBAAiB,EAAE;IACrB,CAAC;EACH,CAAC;EACDC,KAAK,EAAE;IACLZ,WAAWA,CAAA,EAAG;MACZ,IAAI,CAACE,UAAS,GAAI,CAAC;MACnB,IAAI,IAAI,CAACF,WAAU,KAAM,EAAE,EAAE;QAC3B,IAAI,CAACa,cAAc,CAAC,CAAC;QACrB,IAAI,CAACC,YAAY,CAAC,CAAC;MACrB,OAAO;QACL,IAAI,CAACC,KAAK,CAAC,gBAAgB,EAAE;UAC3BC,OAAO,EAAE,EAAE;UACXC,SAAS,EAAEC,IAAI,CAACC,GAAG,CAAC;QACtB,CAAC,CAAC;MACJ;IACF,CAAC;IACDlB,QAAQA,CAAA,EAAG;MACT,IAAI,CAACa,YAAY,CAAC,CAAC;IACrB,CAAC;IACDZ,UAAUA,CAAA,EAAG;MACX,IAAI,CAACY,YAAY,CAAC,CAAC;IACrB,CAAC;IACDL,YAAYA,CAAA,EAAG;MACb,IAAI,CAACK,YAAY,CAAC,CAAC;IACrB,CAAC;IACDJ,oBAAoBA,CAAA,EAAG;MACrB,IAAI,CAACI,YAAY,CAAC,CAAC;IACrB,CAAC;IACDH,iBAAiBA,CAAA,EAAG;MAClB,IAAI,CAACG,YAAY,CAAC,CAAC;MACnB,IAAI,CAACD,cAAc,CAAC,CAAC;IACvB;EACF,CAAC;EACDO,QAAQ,EAAE;IACRC,gBAAgBA,CAAA,EAAG;MACjB,OAAO,IAAI,CAACrB,WAAU,IAAK,CAAC,IAAI,CAACK,WAAW;IAC9C;EACF,CAAC;EACDiB,OAAO,EAAE;IACP,MAAMR,YAAYA,CAAA,EAAG;MACnB,IAAI,IAAI,CAACd,WAAU,KAAM,EAAE,EAAE;QAC3B,IAAI,CAACM,YAAW,GAAI,8BAA8B;QAClD,IAAI,CAACD,WAAU,GAAI,IAAI;QACvB;MACF;MAEA,MAAMkB,IAAG,GAAI,IAAI,CAACd,YAAW,GAAI,IAAI,CAACA,YAAY,CAACe,KAAK,CAAC,CAAC,EAAE,CAAC,IAAI,EAAC;MAClE,IAAIC,QAAO,GAAI,EAAC;MAEhB,IAAI,IAAI,CAACf,oBAAmB,KAAM,iBAAiB,EAAE;QACnDe,QAAO,GAAI,GAAG/B,KAAK,CAACgC,QAAQ,CAACC,OAAO,wCAAwC,IAAI,CAAC3B,WAAW,SAAS,IAAI,CAACE,UAAU,UAAU,IAAI,CAACD,QAAQ,SAASsB,IAAI,EAAE;MAC5J,OAAO;QACLE,QAAO,GAAI,GAAG/B,KAAK,CAACgC,QAAQ,CAACC,OAAO,uCAAuC,IAAI,CAAC3B,WAAW,SAAS,IAAI,CAACE,UAAU,UAAU,IAAI,CAACD,QAAQ,SAASsB,IAAI,cAAc,IAAI,CAACZ,iBAAiB,EAAE;MAC/L;MAEA,MAAMjB,KAAI,CACPkC,GAAG,CAACH,QAAQ,EACZI,IAAI,CAAEC,QAAQ,IAAK;QAClB,IAAIC,aAAY,GAAID,QAAQ,CAAC/B,IAAI,CAACiC,IAAI;QACtC,IAAI,CAACzB,cAAa,GAAIwB,aAAa,CAACE,MAAK,KAAM,CAAC;QAChD,IAAI,CAAC7B,SAAQ,GAAI0B,QAAQ,CAAC/B,IAAI,CAACK,SAAS;;QAExC;QACA,IAAI,CAACW,KAAK,CAAC,gBAAgB,EAAE;UAC3BC,OAAO,EAAEe,aAAa;UACtBd,SAAS,EAAEC,IAAI,CAACC,GAAG,CAAC;QACtB,CAAC,CAAC;QACF,IAAI,CAACd,WAAU,GAAI,KAAK;MAC1B,CAAC,EACA6B,KAAK,CAAEC,KAAK,IAAK;QAChBC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;QACpB,IAAI,CAAC7B,YAAW,GAAI6B,KAAK,CAACL,QAAO,GAC7BK,KAAK,CAACL,QAAQ,CAAC/B,IAAG,GAClB,sCAAsC;QAC1C,IAAI,CAACM,WAAU,GAAI,IAAI;MACzB,CAAC,CAAC;IACN,CAAC;IACD,MAAMQ,cAAcA,CAAA,EAAG;MACrB,MAAMY,QAAO,GAAI,GAAG/B,KAAK,CAACgC,QAAQ,CAACC,OAAO,gDAAgD,IAAI,CAAC3B,WAAW,cAAc,IAAI,CAACW,iBAAiB,EAAE;MAChJ,MAAMjB,KAAI,CACPkC,GAAG,CAACH,QAAQ,EACZI,IAAI,CAAEC,QAAQ,IAAK;QAClB,IAAI,CAACtB,WAAU,GAAI6B,MAAM,CAACC,OAAO,CAACR,QAAQ,CAAC/B,IAAI,CAACwC,aAAa,CAAC,CAACC,GAAG,CAChE,CAAC,CAACjB,IAAI,EAAEkB,KAAK,CAAC,KAAK,GAAGlB,IAAI,KAAKkB,KAAK,GACtC,CAAC;MACH,CAAC,EACAP,KAAK,CAAEC,KAAK,IAAK;QAChBC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACtB,CAAC,CAAC;IACN,CAAC;IACDO,WAAWA,CAAA,EAAG;MACZ,IAAI,CAAC1C,WAAU,GAAI,EAAE;IACvB,CAAC;IACD2C,oBAAoBA,CAAC1C,QAAQ,EAAE;MAC7B,IAAI,CAACC,UAAS,GAAI,CAAC;MACnB,IAAI,CAACC,WAAU,GAAI,CAAC;MACpB,IAAI,CAACF,QAAO,GAAIA,QAAQ;IAC1B,CAAC;IACD2C,gBAAgBA,CAACrB,IAAI,EAAE;MACrB,IAAI,CAACrB,UAAS,GAAI,CAAC;MACnB,IAAI,CAACC,WAAU,GAAI,CAAC;MACpB,IAAI,CAACM,YAAW,GAAIc,IAAI;IAC1B,CAAC;IACDsB,gBAAgBA,CAACC,IAAI,EAAE;MACrB,IAAI,CAAC5C,UAAS,GAAI,CAAC4C,IAAG,GAAI,CAAC,IAAI,IAAI,CAAC7C,QAAQ;MAC5C,IAAI,CAACE,WAAU,GAAI2C,IAAI;IACzB,CAAC;IACDC,wBAAwBA,CAACC,YAAY,EAAE;MACrC,IAAI,CAACtC,oBAAmB,GAAIsC,YAAY;IAC1C,CAAC;IACDC,qBAAqBA,CAACC,SAAS,EAAE;MAC/B,IAAI,CAACvC,iBAAgB,GAAIuC,SAAS;IACpC;EACF;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}