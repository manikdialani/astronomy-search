{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, Transition as _Transition, withCtx as _withCtx, createVNode as _createVNode, resolveComponent as _resolveComponent, withKeys as _withKeys, resolveDirective as _resolveDirective, withDirectives as _withDirectives, createBlock as _createBlock, createTextVNode as _createTextVNode } from \"vue\";\nimport _imports_0 from '../assets/galaxy_logo_white.svg';\nconst _hoisted_1 = {\n  class: \"container\"\n};\nconst _hoisted_2 = {\n  key: 0,\n  class: \"error-message small-text\"\n};\nconst _hoisted_3 = {\n  class: \"search-container\"\n};\nconst _hoisted_4 = {\n  class: \"icon-container\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"no-results-message medium-text\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_InputText = _resolveComponent(\"InputText\");\n  const _component_PaginationBar = _resolveComponent(\"PaginationBar\");\n  const _directive_tooltip = _resolveDirective(\"tooltip\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[3] || (_cache[3] = _createElementVNode(\"a\", {\n    href: \"/\",\n    class: \"image-container\"\n  }, [_createElementVNode(\"img\", {\n    src: _imports_0,\n    class: \"image-logo\",\n    alt: \"My Universe Hub logo\"\n  })], -1 /* HOISTED */)), _createVNode(_Transition, {\n    name: \"fade\"\n  }, {\n    default: _withCtx(() => [$data.errorExists ? (_openBlock(), _createElementBlock(\"div\", _hoisted_2, _toDisplayString($data.errorMessage), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  }), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_InputText, {\n    class: \"input-text medium-text\",\n    type: \"text\",\n    modelValue: $data.searchQuery,\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.searchQuery = $event),\n    placeholder: \"Andromeda galaxy\",\n    onKeyup: _withKeys($options.handleSearch, [\"enter\"])\n  }, null, 8 /* PROPS */, [\"modelValue\", \"onKeyup\"]), _createElementVNode(\"span\", _hoisted_4, [_createVNode(_Transition, {\n    name: \"fade\"\n  }, {\n    default: _withCtx(() => [$data.searchQuery ? _withDirectives((_openBlock(), _createElementBlock(\"i\", {\n      key: 0,\n      class: \"fas fa-times clear-icon\",\n      onClick: _cache[1] || (_cache[1] = (...args) => $options.clearSearch && $options.clearSearch(...args))\n    }, null, 512 /* NEED_PATCH */)), [[_directive_tooltip, 'Clear search', void 0, {\n      top: true\n    }]]) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  })])]), _createVNode(_Transition, {\n    name: \"fade\"\n  }, {\n    default: _withCtx(() => [$options.canPerformSearch ? (_openBlock(), _createBlock(_component_PaginationBar, {\n      key: 0,\n      ref: \"paginationBar\",\n      currentPage: $data.currentPage,\n      maxPages: $data.max_pages,\n      yearOptions: $data.yearOptions,\n      onPageSizeChange: $options.handlePageSizeChange,\n      onYearChange: $options.handleYearChange,\n      onGoToPage: $options.handlePageChange,\n      onSearchMethodChange: $options.handleSearchMethodChange,\n      onTokenizerChange: $options.handleTokenizerChange\n    }, null, 8 /* PROPS */, [\"currentPage\", \"maxPages\", \"yearOptions\", \"onPageSizeChange\", \"onYearChange\", \"onGoToPage\", \"onSearchMethodChange\", \"onTokenizerChange\"])) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  }), _createVNode(_Transition, {\n    name: \"fade\"\n  }, {\n    default: _withCtx(() => [$data.noResultsFound ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, _cache[2] || (_cache[2] = [_createElementVNode(\"i\", {\n      class: \"fas fa-search\"\n    }, null, -1 /* HOISTED */), _createTextVNode(\" No results found. \")]))) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["_imports_0","class","key","_createElementBlock","_hoisted_1","_createElementVNode","href","src","alt","_createVNode","_Transition","name","default","_withCtx","$data","errorExists","_hoisted_2","_toDisplayString","errorMessage","_createCommentVNode","_","_hoisted_3","_component_InputText","type","modelValue","searchQuery","_cache","$event","placeholder","onKeyup","_withKeys","$options","handleSearch","_hoisted_4","onClick","args","clearSearch","top","canPerformSearch","_createBlock","_component_PaginationBar","ref","currentPage","maxPages","max_pages","yearOptions","onPageSizeChange","handlePageSizeChange","onYearChange","handleYearChange","onGoToPage","handlePageChange","onSearchMethodChange","handleSearchMethodChange","onTokenizerChange","handleTokenizerChange","noResultsFound","_hoisted_5","_createTextVNode"],"sources":["C:\\Users\\USER\\Codes\\ElasticSearch_Python_Course\\final_project\\astronomy-search\\frontend\\src\\components\\SearchSection.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <a href=\"/\" class=\"image-container\">\r\n      <img\r\n        src=\"../assets/galaxy_logo_white.svg\"\r\n        class=\"image-logo\"\r\n        alt=\"My Universe Hub logo\"\r\n      />\r\n    </a>\r\n\r\n    <Transition name=\"fade\">\r\n      <div v-if=\"errorExists\" class=\"error-message small-text\">{{ errorMessage }}</div>\r\n    </Transition>\r\n\r\n    <div class=\"search-container\">\r\n      <InputText\r\n        class=\"input-text medium-text\"\r\n        type=\"text\"\r\n        v-model=\"searchQuery\"\r\n        placeholder=\"Andromeda galaxy\"\r\n        @keyup.enter=\"handleSearch\"\r\n      />\r\n      <span class=\"icon-container\">\r\n        <Transition name=\"fade\">\r\n          <i\r\n            v-if=\"searchQuery\"\r\n            class=\"fas fa-times clear-icon\"\r\n            @click=\"clearSearch\"\r\n            v-tooltip.top=\"'Clear search'\"\r\n          ></i>\r\n        </Transition>\r\n      </span>\r\n    </div>\r\n\r\n    <Transition name=\"fade\">\r\n      <PaginationBar\r\n        ref=\"paginationBar\"\r\n        v-if=\"canPerformSearch\"\r\n        :currentPage=\"currentPage\"\r\n        :maxPages=\"max_pages\"\r\n        :yearOptions=\"yearOptions\"\r\n        @page-size-change=\"handlePageSizeChange\"\r\n        @year-change=\"handleYearChange\"\r\n        @go-to-page=\"handlePageChange\"\r\n        @search-method-change=\"handleSearchMethodChange\"\r\n        @tokenizer-change=\"handleTokenizerChange\"\r\n      />\r\n    </Transition>\r\n\r\n    <Transition name=\"fade\">\r\n      <div v-if=\"noResultsFound\" class=\"no-results-message medium-text\">\r\n        <i class=\"fas fa-search\"></i> No results found.\r\n      </div>\r\n    </Transition>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport InputText from \"primevue/inputtext\";\r\nimport PaginationBar from \"./PaginationBar.vue\";\r\n\r\nexport default {\r\n  name: \"SearchSection\",\r\n  components: {\r\n    InputText,\r\n    PaginationBar,\r\n  },\r\n  data() {\r\n    return {\r\n      searchQuery: \"\",\r\n      pageSize: 10,\r\n      pageOffset: 0,\r\n      currentPage: 1,\r\n      max_pages: null,\r\n      errorExists: false,\r\n      errorMessage: \"\",\r\n      noResultsFound: false,\r\n      yearOptions: {},\r\n      selectedYear: null,\r\n      selectedSearchMethod: \"Regular search\",\r\n      selectedTokenizer: \"Standard\"\r\n    };\r\n  },\r\n  watch: {\r\n    searchQuery() {\r\n      this.pageOffset = 0;\r\n      if (this.searchQuery !== \"\") {\r\n        this.getYearOptions();\r\n        this.handleSearch();\r\n      } else {\r\n        this.$emit(\"search-results\", {\r\n          results: [],\r\n          timestamp: Date.now(),\r\n        });\r\n      }\r\n    },\r\n    pageSize() {\r\n      this.handleSearch();\r\n    },\r\n    pageOffset() {\r\n      this.handleSearch();\r\n    },\r\n    selectedYear() {\r\n      this.handleSearch();\r\n    },\r\n    selectedSearchMethod() {\r\n      this.handleSearch();\r\n    },\r\n    selectedTokenizer() {\r\n      this.handleSearch();\r\n      this.getYearOptions();\r\n    }\r\n  },\r\n  computed: {\r\n    canPerformSearch() {\r\n      return this.searchQuery && !this.errorExists;\r\n    },\r\n  },\r\n  methods: {\r\n    async handleSearch() {\r\n      if (this.searchQuery === \"\") {\r\n        this.errorMessage = \"Please enter a search query.\";\r\n        this.errorExists = true;\r\n        return;\r\n      }\r\n\r\n      const year = this.selectedYear ? this.selectedYear.slice(0, 4) : ''\r\n      let endpoint = \"\"\r\n\r\n      if (this.selectedSearchMethod === \"Semantic search\") {\r\n        endpoint = `${axios.defaults.baseURL}/api/v1/semantic_search?search_query=${this.searchQuery}&skip=${this.pageOffset}&limit=${this.pageSize}&year=${year}`;\r\n      } else {\r\n        endpoint = `${axios.defaults.baseURL}/api/v1/regular_search?search_query=${this.searchQuery}&skip=${this.pageOffset}&limit=${this.pageSize}&year=${year}&tokenizer=${this.selectedTokenizer}`;\r\n      }\r\n      \r\n      await axios\r\n        .get(endpoint)\r\n        .then((response) => {\r\n          let searchResults = response.data.hits;\r\n          this.noResultsFound = searchResults.length === 0;\r\n          this.max_pages = response.data.max_pages;\r\n\r\n          // Add timestamp to force reactivity\r\n          this.$emit(\"search-results\", {\r\n            results: searchResults,\r\n            timestamp: Date.now(),\r\n          });\r\n          this.errorExists = false;\r\n        })\r\n        .catch((error) => {\r\n          console.error(error);\r\n          this.errorMessage = error.response\r\n            ? error.response.data\r\n            : 'An error occurred. Please try again.';\r\n          this.errorExists = true;\r\n        });\r\n    },\r\n    async getYearOptions() {\r\n      const endpoint = `${axios.defaults.baseURL}/api/v1/get_docs_per_year_count?search_query=${this.searchQuery}&tokenizer=${this.selectedTokenizer}`;\r\n      await axios\r\n        .get(endpoint)\r\n        .then((response) => {\r\n          this.yearOptions = Object.entries(response.data.docs_per_year).map(\r\n            ([year, count]) => `${year} (${count})`\r\n          );\r\n        })\r\n        .catch((error) => {\r\n          console.error(error);\r\n        });\r\n    },\r\n    clearSearch() {\r\n      this.searchQuery = \"\";\r\n    },\r\n    handlePageSizeChange(pageSize) {\r\n      this.pageOffset = 0;\r\n      this.currentPage = 1;\r\n      this.pageSize = pageSize;\r\n    },\r\n    handleYearChange(year) {\r\n      this.pageOffset = 0;\r\n      this.currentPage = 1;\r\n      this.selectedYear = year;\r\n    },\r\n    handlePageChange(page) {\r\n      this.pageOffset = (page - 1) * this.pageSize;\r\n      this.currentPage = page;\r\n    },\r\n    handleSearchMethodChange(searchMethod) {\r\n      this.selectedSearchMethod = searchMethod;\r\n    },\r\n    handleTokenizerChange(tokenizer) {\r\n      this.selectedTokenizer = tokenizer;\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.container {\r\n  margin-top: 12rem;\r\n}\r\n\r\n.image-container {\r\n  display: block;\r\n  width: 15rem;\r\n  margin-bottom: 10rem;\r\n}\r\n\r\n.image-logo {\r\n  display: block;\r\n  width: 100%;\r\n}\r\n\r\n.search-container {\r\n  width: 100%;\r\n  position: relative;\r\n  display: inline-block;\r\n}\r\n\r\n.icon-container {\r\n  position: absolute;\r\n  right: 1.5rem;\r\n  top: 50%;\r\n  transform: translateY(-50%);\r\n  display: flex;\r\n  gap: 0.75rem;\r\n  align-items: center;\r\n}\r\n\r\n.clear-icon {\r\n  cursor: pointer;\r\n  color: var(--primary-color);\r\n  transition: color 0.3s ease;\r\n  font-size: 3rem;\r\n}\r\n\r\n.clear-icon:hover {\r\n  color: #666;\r\n}\r\n\r\n.input-text {\r\n  width: 100%;\r\n  height: 6rem;\r\n  border-radius: 0rem;\r\n}\r\n\r\n.fade-enter-active,\r\n.fade-leave-active {\r\n  transition: opacity 0.3s ease, transform 0.3s ease;\r\n}\r\n\r\n.fade-enter-from,\r\n.fade-leave-to {\r\n  opacity: 0;\r\n  transform: translateY(1rem);\r\n}\r\n\r\n.fade-enter-to,\r\n.fade-leave-from {\r\n  opacity: 1;\r\n  transform: translateY(0);\r\n}\r\n\r\n.error-message {\r\n  margin-bottom: 0.3rem;\r\n  color: rgb(255, 58, 58);\r\n  padding-left: 0.75rem;\r\n  align-self: flex-start;\r\n}\r\n\r\n.no-results-message {\r\n  margin-top: 2rem;\r\n  text-align: center;\r\n  color: #666;\r\n}\r\n\r\n.no-results-message i {\r\n  margin-right: 0.5rem;\r\n}\r\n\r\n@media screen and (max-width: 1920px) {\r\n  .container {\r\n    margin-top: 10rem;\r\n  }\r\n  \r\n  .image-container {\r\n    width: 10rem;\r\n    margin-bottom: 6rem;\r\n  }\r\n\r\n  .input-text {\r\n    height: 4rem;\r\n  }\r\n\r\n  .icon-container {\r\n    right: 1rem;\r\n  }\r\n\r\n  .clear-icon {\r\n    font-size: 2rem;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 1440px) {\r\n  .container {\r\n    margin-top: 9rem;\r\n  }\r\n  \r\n  .image-container {\r\n    width: 10rem;\r\n    margin-bottom: 5rem;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 992px) {\r\n  .container {\r\n    margin-top: 8rem;\r\n  }\r\n  \r\n  .image-container {\r\n    width: 7rem;\r\n  }\r\n  \r\n  .input-text {\r\n    height: 3rem;\r\n  }\r\n\r\n  .icon-container {\r\n    right: 0.625rem;\r\n  }\r\n\r\n  .clear-icon {\r\n    font-size: 1.5rem;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 768px) {\r\n  .container {\r\n    margin-top: 6rem;\r\n  }\r\n  \r\n  .image-container {\r\n    width: 5rem;\r\n    margin-bottom: 4rem;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 576px) {\r\n  .image-container {\r\n    width: 4rem;\r\n  }\r\n}\r\n\r\n@media screen and (max-width: 480px) {\r\n  .container {\r\n    margin-top: 5rem;\r\n  }\r\n\r\n  .image-container {\r\n    width: 3rem;\r\n    margin-bottom: 3rem;\r\n  }\r\n\r\n  .input-text {\r\n    height: 3rem;\r\n  }\r\n}\r\n</style>\r\n"],"mappings":";OAIQA,UAAqC;;EAHtCC,KAAK,EAAC;AAAW;;EADxBC,GAAA;EAW8BD,KAAK,EAAC;;;EAG3BA,KAAK,EAAC;AAAkB;;EAQrBA,KAAK,EAAC;AAAgB;;EAtBlCC,GAAA;EAkDiCD,KAAK,EAAC;;;;;;uBAjDrCE,mBAAA,CAqDM,OArDNC,UAqDM,G,0BApDJC,mBAAA,CAMI;IANDC,IAAI,EAAC,GAAG;IAACL,KAAK,EAAC;MAChBI,mBAAA,CAIE;IAHAE,GAAqC,EAArCP,UAAqC;IACrCC,KAAK,EAAC,YAAY;IAClBO,GAAG,EAAC;2BAIRC,YAAA,CAEaC,WAAA;IAFDC,IAAI,EAAC;EAAM;IAV3BC,OAAA,EAAAC,QAAA,CAWM,MAAiF,CAAtEC,KAAA,CAAAC,WAAW,I,cAAtBZ,mBAAA,CAAiF,OAAjFa,UAAiF,EAAAC,gBAAA,CAArBH,KAAA,CAAAI,YAAY,oBAX9EC,mBAAA,e;IAAAC,CAAA;MAcIf,mBAAA,CAkBM,OAlBNgB,UAkBM,GAjBJZ,YAAA,CAMEa,oBAAA;IALArB,KAAK,EAAC,wBAAwB;IAC9BsB,IAAI,EAAC,MAAM;IAjBnBC,UAAA,EAkBiBV,KAAA,CAAAW,WAAW;IAlB5B,uBAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAkBiBb,KAAA,CAAAW,WAAW,GAAAE,MAAA;IACpBC,WAAW,EAAC,kBAAkB;IAC7BC,OAAK,EApBdC,SAAA,CAoBsBC,QAAA,CAAAC,YAAY;sDAE5B3B,mBAAA,CASO,QATP4B,UASO,GARLxB,YAAA,CAOaC,WAAA;IAPDC,IAAI,EAAC;EAAM;IAvB/BC,OAAA,EAAAC,QAAA,CAwBU,MAKK,CAJGC,KAAA,CAAAW,WAAW,G,+BADnBtB,mBAAA,CAKK;MA7BfD,GAAA;MA0BYD,KAAK,EAAC,yBAAyB;MAC9BiC,OAAK,EAAAR,MAAA,QAAAA,MAAA,UAAAS,IAAA,KAAEJ,QAAA,CAAAK,WAAA,IAAAL,QAAA,CAAAK,WAAA,IAAAD,IAAA,CAAW;2DACJ,cAAc,E;MAAnBE,GAAG,EAAb;IAA8B,E,KA5B1ClB,mBAAA,e;IAAAC,CAAA;UAkCIX,YAAA,CAaaC,WAAA;IAbDC,IAAI,EAAC;EAAM;IAlC3BC,OAAA,EAAAC,QAAA,CAmCM,MAWE,CATMkB,QAAA,CAAAO,gBAAgB,I,cAFxBC,YAAA,CAWEC,wBAAA;MA9CRtC,GAAA;MAoCQuC,GAAG,EAAC,eAAe;MAElBC,WAAW,EAAE5B,KAAA,CAAA4B,WAAW;MACxBC,QAAQ,EAAE7B,KAAA,CAAA8B,SAAS;MACnBC,WAAW,EAAE/B,KAAA,CAAA+B,WAAW;MACxBC,gBAAgB,EAAEf,QAAA,CAAAgB,oBAAoB;MACtCC,YAAW,EAAEjB,QAAA,CAAAkB,gBAAgB;MAC7BC,UAAU,EAAEnB,QAAA,CAAAoB,gBAAgB;MAC5BC,oBAAoB,EAAErB,QAAA,CAAAsB,wBAAwB;MAC9CC,iBAAgB,EAAEvB,QAAA,CAAAwB;0KA7C3BpC,mBAAA,e;IAAAC,CAAA;MAiDIX,YAAA,CAIaC,WAAA;IAJDC,IAAI,EAAC;EAAM;IAjD3BC,OAAA,EAAAC,QAAA,CAkDM,MAEM,CAFKC,KAAA,CAAA0C,cAAc,I,cAAzBrD,mBAAA,CAEM,OAFNsD,UAEM,EAAA/B,MAAA,QAAAA,MAAA,OADJrB,mBAAA,CAA6B;MAA1BJ,KAAK,EAAC;IAAe,4BAnDhCyD,gBAAA,CAmDqC,qBAC/B,E,MApDNvC,mBAAA,e;IAAAC,CAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}